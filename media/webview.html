<!-- filepath: d:\VSCodeExtension\vscodeext\media\webview.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example Webview</title>
    <style>
        .row {
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>

<body>
    <h1>TSO BUS</h1>
    <div class="row">
        <label for="libreriaInput">Libreria:</label>
        <input type="text" id="libreriaInput" value="T09579.JCLLIB(BU3)" />
    </div>
    <div class="row">
        <label for="elementoInput">Elemento:</label>
        <input type="text" id="elementoInput" value="BCVVCU20" />

        <button id="matriculaBuscar">Buscar</button>

        <p id="additionalOutput"></p>
    </div>
    commandOutput <p id="commandOutput">commandOutput</p>

    errorOutput <p id="errorOutput">Error output will appear here</p>
    stderrOutput <p id="stderrOutput">Stderr output will appear here</p>
    stdoutOutput <p id="stdoutOutput">Stdout output will appear here</p>

    <script>
        const vscode = acquireVsCodeApi();
        const libreriaValue = document.getElementById('libreriaInput').value;
        const elementoValue = document.getElementById('elementoInput').value;

        // Escuchar mensajes desde el backend
        window.addEventListener('message', (event) => {
            const message = event.data;
            if (message.command === 'errorMessage') {
                // Actualizar el contenido del <p> con el valor de error.message
                document.getElementById('errorOutput').textContent = `Error: ${message.errorMessage}`;
            }
            if (message.command === 'stderrOutput') {
                // Actualizar el contenido del <p> con el valor de stderr
                document.getElementById('stderrOutput').textContent = `Stderr: ${message.stderr}`;
            }
            if (message.command === 'stdoutOutput') {
                // Actualizar el contenido del <p> con el valor de stdout
                document.getElementById('stdoutOutput').textContent = `Stdout: ${message.stdout}`;
            }
        });

        document.getElementById('additionalOutput').textContent = libreriaValue + ' PRG ' + elementoValue;

        document.getElementById('libreriaInput').addEventListener('input', (event) => {
            const libreriaValue = event.target.value;
            const elementoValue = document.getElementById('elementoInput').value;
            document.getElementById('additionalOutput').textContent = libreriaValue + ' PRG' + elementoValue;
        });

        document.getElementById('matriculaBuscar').addEventListener('click', () => {
            const elementoValue = document.getElementById('elementoInput').value;
            const libreriaValue = document.getElementById('libreriaInput').value;

            const zoweCommandConcat = 'zowe tso issue cmd "EX \'' + libreriaValue + '\' \'PRG ' + elementoValue + '\'" -a 9999/UTI/00';

            document.getElementById('commandOutput').textContent = 'Generated Command: ' + zoweCommandConcat;

            vscode.postMessage({ command: 'runZoweCommand', zoweCommand: zoweCommandConcat });
        });
    </script>
</body>

</html>